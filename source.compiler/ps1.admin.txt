Function IsNotAdmin {$CurrentUser = New-Object Security.Principal.WindowsPrincipal $([Security.Principal.WindowsIdentity]::GetCurrent());$CurrentUser.IsInRole([Security.Principal.WindowsBuiltinRole]::Administrator) -eq $False}
If (IsNotAdmin){Try{Start-Process powershell.exe -Verb RunAs -ArgumentList ("-Exec bypass -NoProfile -File `"$($MyInvocation.MyCommand.Definition)`" $([String]$Args)");Start-Sleep -m 500;exit 0}
  Catch [System.InvalidOperationException]{Write-Host "`nRight-click script then select `"Run as administrator`"`n";Exit 1}
  Finally{If(IsError){Write-Throw;Exit 1}Exit 0}
};